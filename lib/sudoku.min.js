Sudoku={};Sudoku.Cell=function(e,t){if(!e){this.index=0}else{this.index=e}if(!t){this.value=0}else{this.value=t}this.row=this.getRowIndex();this.column=this.getColumnIndex();this.block=this.getBlockIndex()};Sudoku.Cell.prototype.getRowIndex=function(){return Math.floor(this.index/9)};Sudoku.Cell.prototype.getColumnIndex=function(){return this.index%9};Sudoku.Cell.prototype.getBlockIndex=function(){var e=this.getRowIndex();var t=this.getColumnIndex();if(e>=0&&e<=2){if(t>=0&&t<=2){return 0}else if(t>=3&&t<=5){return 1}else if(t>=6&&t<=8){return 2}}else if(e>=3&&e<=5){if(t>=0&&t<=2){return 3}else if(t>=3&&t<=5){return 4}else if(t>=6&&t<=8){return 5}}else if(e>=6&&e<=8){if(t>=0&&t<=2){return 6}else if(t>=3&&t<=5){return 7}else if(t>=6&&t<=8){return 8}}};Sudoku.Board=function(e){this.cells=[];if(e){this.givens=e}else{this.givens=[]}for(var t=0;t<81;t++){if(this.givens[t]){this.cells[t]=new Sudoku.Cell(t,this.givens[t])}else{this.cells[t]=new Sudoku.Cell(t,0)}}};Sudoku.Board.prototype.isCompleted=function(){for(var e=0;e<81;e++){if(!this.cells[e]||this.cells[e].value==0){return false}else{var t=new Sudoku.Cell(e,this.cells[e].value);if(this.isConflict(t)){return false}}}return true};Sudoku.Board.prototype.clear=function(e){this.cells=[];if(e){this.givens=[]}for(var t=0;t<81;t++){if(!e&&this.givens[t]){this.cells[t]=new Sudoku.Cell(t,this.givens[t]);continue}this.cells[t]=new Sudoku.Cell(t,0)}};Sudoku.Board.prototype.isConflict=function(e){for(var t=0;t<this.cells.length;t++){if(t==e.index){continue}var n=this.cells[t];if(n.row==e.row||n.column==e.column||n.block==e.block){if(n.value==e.value){return true}}}return false};Sudoku.rand=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)};Sudoku.solve=function(e){e.clear();var t=[];var n=0;for(var r=0;r<81;r++){t[r]=[];for(var i=1;i<=9;i++){t[r].push(i)}}do{if(e.givens[n]){n+=1;continue}if(t[n].length!=0){var s=Sudoku.rand(0,t[n].length-1);var o=t[n][s];var u=new Sudoku.Cell(n,o);if(!e.isConflict(u)){e.cells[n]=u;t[n].splice(s,1);n+=1}else{t[n].splice(s,1)}}else{for(var r=1;r<=9;r++){t[n].push(r)}n-=1;while(e.givens[n]){n-=1}e.cells[n]=new Sudoku.Cell}if(n<0){return false}}while(n<81);return true};Sudoku.generate=function(e,t){e.clear(true);Sudoku.solve(e);for(var n=0;n<81;n++){e.givens[n]=e.cells[n].value}var r=81;var i;var s;var o=[];var u=[];var a=[];var f=[];for(var n=0;n<81;n++){f.push(n)}for(var n=0;n<9;n++){o[n]=0;u[n]=0;a[n]=0}switch(t){case"easiest":i=Sudoku.rand(50,70);s=4;break;case"easy":i=Sudoku.rand(36,49);s=5;break;case"normal":i=Sudoku.rand(32,35);s=6;break;case"hard":i=Sudoku.rand(28,31);s=7;break;case"hardest":i=Sudoku.rand(22,27);s=9;break}var l=new Date;while(f.length>0&&r>i){if(new Date-l>2e3){break}var c=Sudoku.rand(0,f.length-1);var n=f[c];f.splice(c,1);var h=e.cells[n];var p=true;if(a[h.block]>=s&&u[h.column]>=s&&o[h.row]>=s){continue}for(var d=1;d<=9;d++){if(d==h.value){continue}var v=new Sudoku.Cell(n,d);if(e.isConflict(v)){continue}e.givens[n]=d;e.cells[n]=v;if(Sudoku.solve(e)){p=false;break}}if(p){e.givens[n]=null;e.cells[n]=new Sudoku.Cell;o[h.row]+=1;u[h.column]+=1;a[h.block]+=1;r-=1}else{e.givens[n]=h.value;e.cells[n]=h}e.clear()}var m=0;for(var g=0;g<81;g++){if(e.givens[g]){m+=1}}}